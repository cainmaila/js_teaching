<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Pixi - 鍵盤操作</title>
    <style>
    * {
        padding: 0;
        margin: 0
    }
    
    body {
        background-color: #1099bb;
    }
    </style>
</head>

<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.3.5/pixi.min.js"></script>
    <script>
    var renderer = PIXI.autoDetectRenderer(window.innerWidth, window.innerHeight, {
        antialias: false,
        transparent: true,
        resolution: 1
    });

    document.body.appendChild(renderer.view);

    var stage = new PIXI.Container();
    var tilingSprite;
    var me;
    var v = 2;
    //載入
    PIXI.loader
        .add("./images/sea.jpg")
        .add("./images/me.png")
        .load(setup);

    function setup() {
        //取得素材
        var texture = PIXI.Texture.fromImage('./images/sea.jpg');
        //建立重複元件
        tilingSprite = new PIXI.extras.TilingSprite(texture, 800, 800);
        //建立飛機物件
        me = new PIXI.Sprite(PIXI.Texture.fromImage('./images/me.png'));
        me.x = 400;
        me.y = 400;
        //新增到stage
        stage.addChild(tilingSprite);
        stage.addChild(me);
        //觸發鍵盤
        window.addEventListener('keydown', onKeydown);
        animation();
    }

    function onKeydown(event) {
        console.log(event.key);
        if (event.key === 'ArrowRight') {
            me.x += 5;
        } else if (event.key === 'ArrowLeft') {
            me.x -= 5;
        } else if (event.key === 'ArrowUp') {
            v += 0.1;
        } else if (event.key === 'ArrowDown') {
            v -= 0.1;
        }
    }

    //全螢幕設置
    renderer.view.style.position = "absolute"; //canvas css position:absolute
    renderer.view.style.display = "block"; //canvas css display:block
    renderer.autoResize = true; //canvas Resize自動重算
    window.onresize = function() { //觸發onresize
        renderer.resize(window.innerWidth, window.innerHeight); //canvas resize
        renderer.render(stage);
    }

    //動畫
    function animation() {
        //移動底圖
        tilingSprite.tilePosition.y += v;
        renderer.render(stage);
        requestAnimationFrame(animation);
    }
    </script>
</body>

</html>
