<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>利用物件生成元件 - 繼承2</title>
    <style>
    * {
        padding: 0;
        margin: 0
    }
    
    body {
        background-color: #fff;
    }
    </style>
</head>

<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.3.5/pixi.min.js"></script>
    <script>
    var renderer = PIXI.autoDetectRenderer(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.view);
    var stage = new PIXI.Container();

    //載入素材
    PIXI.loader
        .add("./images/mc.png")
        .load(setup);

    //載入完成
    function setup() {

        //生成Ghost物件
        var ghost1 = new Ghost(200, 200, true)
        stage.addChild(ghost1.mc)

        var ghost2 = new Ghost(600, 400)
        stage.addChild(ghost2.mc)

        renderer.render(stage);
        animation()

        //動畫
        function animation() {
            ghost1.play(5)
            ghost2.play(2)
            renderer.render(stage);
            requestAnimationFrame(animation);
        }
    }



    //物件

    //Ghost.mc 就是 PIXI.Sprite 實體
    function Ghost(x, y, isRight) {
        var mc = new PIXI.Sprite()
        mc.texture = PIXI.loader.resources["./images/mc.png"].texture
        mc.anchor.set(0.5)
        if (isRight) {
            mc.scale.x = -1
        }
        mc.x = x
        mc.y = y
        this.mc = mc
        this.isRight = isRight
    }

    Ghost.prototype.play = function(v) {
        var mc = this.mc

        //根據面對方向來移動位置
        if (this.isRight) {
            mc.x += v
        } else {
            mc.x -= v
        }

        //邊界判定
        if (mc.x > window.innerHeight) {
            this.isRight = false
            mc.scale.x = 1
        } else if (mc.x < 0) {
            this.isRight = true
            mc.scale.x = -1
        }
    }



    //全螢幕設置
    renderer.view.style.position = "absolute"; //canvas css position:absolute
    renderer.view.style.display = "block"; //canvas css display:block
    renderer.autoResize = true; //canvas Resize自動重算
    window.onresize = function() { //觸發onresize
        renderer.resize(window.innerWidth, window.innerHeight); //canvas resize
        renderer.render(stage);
    }
    </script>
</body>

</html>
